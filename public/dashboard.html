<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZapManejo - Painel de Controle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f6fa;
            color: #2c3e50;
        }

        /* Header */
        .header {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
            color: #27ae60;
        }

        .ranch-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .ranch-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .trial-timer {
            background: #ff6b6b;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        /* Tab Navigation */
        .tab-nav {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            position: sticky;
            top: 70px;
            z-index: 99;
        }

        .tab-nav-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: #666;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: #f8f9fa;
            color: #27ae60;
        }

        .tab-btn.active {
            color: #27ae60;
            border-bottom-color: #27ae60;
        }

        .tab-btn span {
            margin-right: 8px;
        }

        /* Tab Content */
        .tab-content {
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Dashboard Overview */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
        }

        .stat-change {
            color: #27ae60;
            font-size: 14px;
            margin-top: 5px;
        }

        /* Inventory Table */
        .inventory-controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .filter-btn, .action-btn {
            padding: 10px 20px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }

        .filter-btn:hover, .action-btn:hover {
            background: #229954;
        }

        .inventory-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 140px;
            z-index: 10;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .tag-badge {
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 13px;
        }

        .status-healthy {
            color: #27ae60;
        }

        .status-sick {
            color: #ff6b6b;
        }

        /* WhatsApp Hub */
        .whatsapp-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
            height: calc(100vh - 200px);
        }

        .message-list {
            background: white;
            border-radius: 10px;
            overflow-y: auto;
            padding: 20px;
        }

        .message-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s;
        }

        .message-item:hover {
            background: #f8f9fa;
        }

        .message-sender {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .message-preview {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .message-time {
            color: #999;
            font-size: 12px;
        }

        .chat-window {
            background: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #e5ddd5;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
        }

        .chat-message.sent {
            justify-content: flex-end;
        }

        .message-bubble {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 10px;
            background: white;
        }

        .message-bubble.sent {
            background: #dcf8c6;
        }

        .chat-input {
            padding: 20px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
        }

        .send-btn {
            padding: 10px 20px;
            background: #25d366;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }

        .chart-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .chart-placeholder {
            height: 300px;
            background: #f8f9fa;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
        }

        /* Weather Widget */
        .weather-widget {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
        }

        .weather-main {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .weather-temp {
            font-size: 48px;
            font-weight: bold;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        /* File Upload */
        .upload-zone {
            background: white;
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-zone:hover {
            border-color: #27ae60;
            background: #f8f9fa;
        }

        .upload-icon {
            font-size: 48px;
            color: #999;
            margin-bottom: 10px;
        }

        /* Milk Production */
        .milk-form {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .form-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .whatsapp-container {
                grid-template-columns: 1fr;
            }
            
            .tab-nav-content {
                overflow-x: auto;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Notifications */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .notification.show {
            display: block;
        }
        </style>
    <!-- Add Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <span>üêÑ</span>
                <span>ZapManejo</span>
            </div>
            <div class="ranch-info">
                <select id="languageSelector" style="padding: 5px 10px; border-radius: 5px; border: 1px solid #ddd; margin-right: 15px;">
                    <option value="pt">üáßüá∑ Portugu√™s</option>
                    <option value="es">üá™üá∏ Espa√±ol</option>
                    <option value="en">üá∫üá∏ English</option>
                </select>
                <div class="ranch-name" id="ranchName">Fazenda Demo</div>
                <div class="trial-timer" id="trialTimer">36:00:00 restantes</div>
            </div>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-nav">
        <div class="tab-nav-content">
            <button class="tab-btn active" onclick="switchTab('dashboard')">
                <span>üìä</span>Painel
            </button>
            <button class="tab-btn" onclick="switchTab('inventory')">
                <span>üìã</span>Invent√°rio
            </button>
            <button class="tab-btn" onclick="switchTab('whatsapp')">
                <span>üí¨</span>WhatsApp
            </button>
            <button class="tab-btn" onclick="switchTab('analytics')">
                <span>üìà</span>An√°lises
            </button>
            <button class="tab-btn" onclick="switchTab('weather')">
                <span>‚òÅÔ∏è</span>Clima
            </button>
            <button class="tab-btn" onclick="switchTab('milk')">
                <span>ü•õ</span>Produ√ß√£o de Leite
            </button>
            <button class="tab-btn" onclick="switchTab('documents')">
                <span>üìÅ</span>Documentos
            </button>
        </div>
    </div>

    <!-- Dashboard Tab -->
    <div class="tab-content active" id="dashboard-tab">
        <!-- Demo Notice -->
        <div style="background: #fff3cd; border: 1px solid #ffc107; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
            <strong>‚ö†Ô∏è Modo Demonstra√ß√£o</strong> - Os dados mostrados s√£o fict√≠cios. Quando voc√™ se tornar assinante, voc√™ poder√°:
            <ul style="margin-top: 10px; margin-left: 20px;">
                <li>Cadastrar seus pastos reais com nomes e tamanhos personalizados</li>
                <li>Registrar seu rebanho completo: <strong>Bovinos üêÑ, Bubalinos üêÉ, Equinos üê¥, Su√≠nos üê∑ e Ovinos üêë</strong></li>
                <li>Adicionar seus vaqueiros e funcion√°rios reais</li>
                <li>Configurar alertas personalizados e relat√≥rios</li>
            </ul>
            <strong>üìû Suporte completo inclu√≠do para todos os tipos de cria√ß√£o!</strong>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total de Animais</div>
                <div class="stat-value" id="totalCattle">150</div>
                <div class="stat-change">üêÑ Bovinos: 120 | üêÉ B√∫falos: 30</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Nascimentos (M√™s)</div>
                <div class="stat-value" id="birthsMonth">12</div>
                <div class="stat-change">+2 esta semana</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Vacina√ß√µes Pendentes</div>
                <div class="stat-value" id="vaccinations">23</div>
                <div class="stat-change">Pr√≥xima: 3 dias</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Tipos de Cria√ß√£o</div>
                <div class="stat-value">5</div>
                <div class="stat-change">üêÑüêÉüê¥üê∑üêë Todos suportados!</div>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-title">Atividade Recente</div>
            <div id="recentActivity">
                <!-- Activity items will be added here -->
            </div>
        </div>
    </div>

    <!-- Inventory Tab -->
    <div class="tab-content" id="inventory-tab">
        <div class="inventory-controls">
            <input type="text" class="search-box" placeholder="Buscar por brinco, ra√ßa, pasto..." id="searchInput">
            <select class="form-input">
                <option>Todos os Pastos</option>
                <option>Pasto Esperan√ßa</option>
                <option>Pasto Vit√≥ria</option>
                <option>Pasto Liberdade</option>
                <option>Pasto Progresso</option>
                <option>Pasto Horizonte</option>
            </select>
            <button class="filter-btn">Filtrar</button>
            <button class="action-btn">+ Adicionar Animal</button>
            <button class="action-btn">Exportar CSV</button>
        </div>

        <div class="inventory-table">
            <table>
                <thead>
                    <tr>
                        <th>Brinco/ID</th>
                        <th>Tipo</th>
                        <th>Ra√ßa</th>
                        <th>Sexo</th>
                        <th>Idade</th>
                        <th>Peso (kg)</th>
                        <th>Pasto</th>
                        <th>Sa√∫de</th>
                        <th>√öltima Vacina√ß√£o</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="inventoryTableBody">
                    <!-- Cattle rows will be added here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- WhatsApp Tab -->
    <div class="tab-content" id="whatsapp-tab">
        <div class="whatsapp-container">
            <div class="message-list">
                <h3 style="margin-bottom: 20px;">Mensagens Recentes</h3>
                <div id="messageList">
                    <!-- Messages will be listed here -->
                </div>
            </div>
            <div class="chat-window">
                <div class="chat-header">
                    <strong id="chatWith">Selecione uma conversa</strong>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <!-- Chat messages will appear here -->
                </div>
                <div class="chat-input">
                    <input type="text" placeholder="Digite sua mensagem..." id="messageInput">
                    <button class="send-btn" onclick="sendMessage()">Enviar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Analytics Tab -->
    <div class="tab-content" id="analytics-tab">
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-title">Crescimento do Rebanho</div>
                <div class="chart-placeholder">
                    <canvas id="growthChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-title">Distribui√ß√£o por Pasto</div>
                <div class="chart-placeholder">
                    <canvas id="pastureChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-title">Custos Mensais</div>
                <div class="chart-placeholder">
                    <canvas id="costsChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-title">Taxa de Natalidade</div>
                <div class="chart-placeholder">
                    <canvas id="birthRateChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Weather Tab -->
   <!-- Weather Tab -->
<div class="tab-content" id="weather-tab">
    <!-- ADD THIS INPUT SECTION -->
    <div style="text-align: center; margin-bottom: 20px;">
        <input type="text" id="cityInput" placeholder="Digite a cidade... (ex: Cuiab√°, MT)" style="padding: 10px; width: 300px; border-radius: 5px; border: 1px solid #ddd;">
        <button onclick="getWeather()" class="action-btn" style="margin-left: 10px;">Buscar Clima</button>
    </div>
    
    <div class="weather-widget">
        <h2>Clima - <span id="weatherLocation">Fazenda Demo</span></h2>
        <div class="weather-main">
            <div class="weather-temp" id="temperature">--¬∞C</div>
            <div>
                <div id="weatherDescription">Aguardando busca...</div>
                <div id="cityName">Digite uma cidade</div>
            </div>
        </div>
        <div class="weather-details">
            <div>
                <div>Umidade</div>
                <div id="humidity">--%</div>
            </div>
            <div>
               
                <div>Vento</div>
                <div id="windSpeed">-- km/h</div>
            </div>
            <div>
                <div>Sensa√ß√£o</div>
                <div id="feelsLike">--¬∞C</div>
            </div>
            <div>
                <div>Press√£o</div>
                <div id="pressure">-- hPa</div>
            </div>
        </div>
    </div>
    <div class="chart-card" style="margin-top: 20px;">
        <div class="chart-title">Alertas para Pecuaristas</div>
        <div id="ranchTip" style="padding: 20px; font-size: 16px; line-height: 1.5;">
            Digite uma cidade para ver alertas baseados no clima.
        </div>
    </div>
</div>    <!-- Milk Production Tab -->
    <div class="tab-content" id="milk-tab">
        <div class="milk-form">
            <h3>Registrar Produ√ß√£o de Leite de B√∫fala</h3>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Data</label>
                    <input type="date" class="form-input" id="milkDate">
                </div>
                <div class="form-group">
                    <label class="form-label">B√∫fala ID</label>
                    <input type="text" class="form-input" placeholder="Ex: BUF001">
                </div>
                <div class="form-group">
                    <label class="form-label">Litros (Manh√£)</label>
                    <input type="number" class="form-input" placeholder="0.0">
                </div>
                <div class="form-group">
                    <label class="form-label">Litros (Tarde)</label>
                    <input type="number" class="form-input" placeholder="0.0">
                </div>
            </div>
            <button class="action-btn">Registrar Produ√ß√£o</button>
        </div>
        
        <div class="chart-card">
            <div class="chart-title">Produ√ß√£o Mensal</div>
            <div class="chart-placeholder">Gr√°fico de produ√ß√£o de leite aqui</div>
        </div>
    </div>

    <!-- Documents Tab -->
    <div class="tab-content" id="documents-tab">
        <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
            <div class="upload-icon">üì§</div>
            <h3>Arraste arquivos aqui ou clique para fazer upload</h3>
            <p>Aceita CSV, Excel, PDF, Imagens</p>
            <input type="file" id="fileInput" style="display: none;" multiple accept=".csv,.xlsx,.xls,.pdf,.jpg,.png">
        </div>
        
        <div class="inventory-table" style="margin-top: 20px;">
            <table>
                <thead>
                    <tr>
                        <th>Nome do Arquivo</th>
                        <th>Tipo</th>
                        <th>Tamanho</th>
                        <th>Data de Upload</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="documentsTableBody">
                    <tr>
                        <td>inventario_janeiro_2024.csv</td>
                        <td>CSV</td>
                        <td>24 KB</td>
                        <td>15/01/2024</td>
                        <td><button class="action-btn">Baixar</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Translations
        const translations = {
            pt: {
                panel: 'Painel',
                inventory: 'Invent√°rio',
                whatsapp: 'WhatsApp',
                analytics: 'An√°lises',
                weather: 'Clima',
                milk: 'Produ√ß√£o de Leite',
                documents: 'Documentos',
                demoMode: 'Modo Demonstra√ß√£o',
                demoNotice: 'Os dados mostrados s√£o fict√≠cios. Quando voc√™ se tornar assinante, voc√™ poder√°:',
                customizePastures: 'Cadastrar seus pastos reais com nomes e tamanhos personalizados',
                registerHerd: 'Registrar seu rebanho completo: Bovinos üêÑ, Bubalinos üêÉ, Equinos üê¥, Su√≠nos üê∑ e Ovinos üêë',
                addWorkers: 'Adicionar seus vaqueiros e funcion√°rios reais',
                configureAlerts: 'Configurar alertas personalizados e relat√≥rios',
                fullSupport: 'Suporte completo inclu√≠do para todos os tipos de cria√ß√£o!',
                totalAnimals: 'Total de Animais',
                birthsMonth: 'Nascimentos (M√™s)',
                pendingVaccinations: 'Vacina√ß√µes Pendentes',
                livestockTypes: 'Tipos de Cria√ß√£o',
                allSupported: 'Todos suportados!',
                search: 'Buscar por brinco, ra√ßa, pasto...',
                allPastures: 'Todos os Pastos',
                filter: 'Filtrar',
                addAnimal: '+ Adicionar Animal',
                exportCSV: 'Exportar CSV',
                tagId: 'Brinco/ID',
                type: 'Tipo',
                breed: 'Ra√ßa',
                gender: 'Sexo',
                age: 'Idade',
                weight: 'Peso (kg)',
                pasture: 'Pasto',
                health: 'Sa√∫de',
                lastVaccination: '√öltima Vacina√ß√£o',
                actions: 'A√ß√µes',
                edit: 'Editar',
                male: 'Macho',
                female: 'F√™mea',
                months: 'meses',
                healthy: 'Saud√°vel',
                inTreatment: 'Em Tratamento',
                remaining: 'restantes',
                thisWeek: 'esta semana',
                nextIn: 'Pr√≥xima em',
                days: 'dias',
                cattle: 'Bovinos',
                buffalo: 'B√∫falos'
            },
            es: {
                panel: 'Panel',
                inventory: 'Inventario',
                whatsapp: 'WhatsApp',
                analytics: 'An√°lisis',
                weather: 'Clima',
                milk: 'Producci√≥n de Leche',
                documents: 'Documentos',
                demoMode: 'Modo Demostraci√≥n',
                demoNotice: 'Los datos mostrados son ficticios. Cuando te conviertas en suscriptor, podr√°s:',
                customizePastures: 'Registrar tus pastos reales con nombres y tama√±os personalizados',
                registerHerd: 'Registrar tu reba√±o completo: Bovinos üêÑ, B√∫falos üêÉ, Equinos üê¥, Porcinos üê∑ y Ovinos üêë',
                addWorkers: 'Agregar tus vaqueros y empleados reales',
                configureAlerts: 'Configurar alertas personalizadas e informes',
                fullSupport: '¬°Soporte completo incluido para todos los tipos de cr√≠a!',
                totalAnimals: 'Total de Animales',
                birthsMonth: 'Nacimientos (Mes)',
                pendingVaccinations: 'Vacunaciones Pendientes',
                livestockTypes: 'Tipos de Cr√≠a',
                allSupported: '¬°Todos soportados!',
                search: 'Buscar por arete, raza, pasto...',
                allPastures: 'Todos los Pastos',
                filter: 'Filtrar',
                addAnimal: '+ Agregar Animal',
                exportCSV: 'Exportar CSV',
                tagId: 'Arete/ID',
                type: 'Tipo',
                breed: 'Raza',
                gender: 'Sexo',
                age: 'Edad',
                weight: 'Peso (kg)',
                pasture: 'Pasto',
                health: 'Salud',
                lastVaccination: '√öltima Vacunaci√≥n',
                actions: 'Acciones',
                edit: 'Editar',
                male: 'Macho',
                female: 'Hembra',
                months: 'meses',
                healthy: 'Saludable',
                inTreatment: 'En Tratamiento',
                remaining: 'restantes',
                thisWeek: 'esta semana',
                nextIn: 'Pr√≥xima en',
                days: 'd√≠as',
                cattle: 'Bovinos',
                buffalo: 'B√∫falos'
            },
            en: {
                panel: 'Dashboard',
                inventory: 'Inventory',
                whatsapp: 'WhatsApp',
                analytics: 'Analytics',
                weather: 'Weather',
                milk: 'Milk Production',
                documents: 'Documents',
                demoMode: 'Demo Mode',
                demoNotice: 'The data shown is fictitious. When you become a subscriber, you will be able to:',
                customizePastures: 'Register your real pastures with custom names and sizes',
                registerHerd: 'Register your complete herd: Cattle üêÑ, Buffalo üêÉ, Horses üê¥, Swine üê∑ and Sheep üêë',
                addWorkers: 'Add your real cowboys and employees',
                configureAlerts: 'Configure custom alerts and reports',
                fullSupport: 'Full support included for all types of livestock!',
                totalAnimals: 'Total Animals',
                birthsMonth: 'Births (Month)',
                pendingVaccinations: 'Pending Vaccinations',
                livestockTypes: 'Livestock Types',
                allSupported: 'All supported!',
                search: 'Search by tag, breed, pasture...',
                allPastures: 'All Pastures',
                filter: 'Filter',
                addAnimal: '+ Add Animal',
                exportCSV: 'Export CSV',
                tagId: 'Tag/ID',
                type: 'Type',
                breed: 'Breed',
                gender: 'Gender',
                age: 'Age',
                weight: 'Weight (kg)',
                pasture: 'Pasture',
                health: 'Health',
                lastVaccination: 'Last Vaccination',
                actions: 'Actions',
                edit: 'Edit',
                male: 'Male',
                female: 'Female',
                months: 'months',
                healthy: 'Healthy',
                inTreatment: 'In Treatment',
                remaining: 'remaining',
                thisWeek: 'this week',
                nextIn: 'Next in',
                days: 'days',
                cattle: 'Cattle',
                buffalo: 'Buffalo'
            }
        };

        let currentLang = 'pt';
        let t = translations[currentLang];

        // Demo data
        let demoData = {
            ranchName: 'Fazenda Demo',
            totalCattle: 150,
            birthsMonth: 12,
            vaccinations: 23,
            cattle: [],
            messages: [],
            activities: []
        };

        // Generate demo cattle
        function generateDemoCattle() {
            const breeds = ['Nelore', 'Angus', 'Brahman', 'Gir', 'Guzer√°'];
            const pastures = ['Pasto Esperan√ßa', 'Pasto Vit√≥ria', 'Pasto Liberdade', 'Pasto Progresso', 'Pasto Horizonte'];
            
            for (let i = 1; i <= 150; i++) {
                demoData.cattle.push({
                    tag: `BOV${String(i).padStart(3, '0')}`,
                    breed: breeds[Math.floor(Math.random() * breeds.length)],
                    gender: Math.random() > 0.5 ? 'Macho' : 'F√™mea',
                    age: Math.floor(Math.random() * 60) + 6, // 6-66 months
                    weight: Math.floor(Math.random() * 300) + 300, // 300-600kg
                    pasture: pastures[Math.floor(Math.random() * pastures.length)],
                    health: Math.random() > 0.9 ? 'Em Tratamento' : 'Saud√°vel',
                    lastVaccine: new Date(Date.now() - Math.random() * 60 * 24 * 60 * 60 * 1000).toLocaleDateString('pt-BR')
                });
            }
        }

        // Generate demo messages
        function generateDemoMessages() {
            const vaqueiros = ['Jo√£o Santos', 'Pedro Silva', 'Carlos Oliveira', 'Miguel Costa', 'Jos√© Ferreira'];
            const messages = [
                'Nasceu 2 bezerros hoje no pasto norte',
                'Vacinei o lote 15 contra aftosa',
                'Transferi 30 cabe√ßas para o pasto sul',
                'Chuva de 25mm registrada',
                'Peso da vaca 501: 420kg'
            ];
            
            for (let i = 0; i < 10; i++) {
                demoData.messages.push({
                    sender: vaqueiros[Math.floor(Math.random() * vaqueiros.length)],
                    message: messages[Math.floor(Math.random() * messages.length)],
                    time: new Date(Date.now() - Math.random() * 24 * 60 * 60 * 1000),
                    phone: `+55 65 9${Math.floor(Math.random() * 10000000 + 10000000)}`
                });
            }
        }

        // Switch tabs
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Mark button as active
            event.target.classList.add('active');
            
            // Load tab-specific data
            if (tabName === 'inventory') {
                loadInventory();
            } else if (tabName === 'whatsapp') {
                loadMessages();
            }
        }

        // Load inventory
        function loadInventory() {
            const tbody = document.getElementById('inventoryTableBody');
            tbody.innerHTML = '';
            
            demoData.cattle.forEach(animal => {
                const row = `
                    <tr>
                        <td><span class="tag-badge">${animal.tag}</span></td>
                        <td>${animal.type}</td>
                        <td>${animal.breed}</td>
                        <td>${animal.gender}</td>
                        <td>${animal.age} meses</td>
                        <td>${animal.weight}</td>
                        <td>${animal.pasture}</td>
                        <td class="${animal.health === 'Saud√°vel' ? 'status-healthy' : 'status-sick'}">${animal.health}</td>
                        <td>${animal.lastVaccine}</td>
                        <td><button class="action-btn">Editar</button></td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Load WhatsApp messages
        function loadMessages() {
            const messageList = document.getElementById('messageList');
            messageList.innerHTML = '';
            
            demoData.messages.sort((a, b) => b.time - a.time).forEach(msg => {
                const item = `
                    <div class="message-item" onclick="openChat('${msg.sender}', '${msg.phone}')">
                        <div class="message-sender">${msg.sender}</div>
                        <div class="message-preview">${msg.message}</div>
                        <div class="message-time">${msg.time.toLocaleString('pt-BR')}</div>
                    </div>
                `;
                messageList.innerHTML += item;
            });
        }

        // Open chat
        function openChat(sender, phone) {
            document.getElementById('chatWith').textContent = `${sender} - ${phone}`;
            document.getElementById('chatMessages').innerHTML = `
                <div class="chat-message">
                    <div class="message-bubble">Ol√°! Como est√° o gado hoje?</div>
                </div>
                <div class="chat-message sent">
                    <div class="message-bubble sent">Tudo bem! Nasceu 2 bezerros hoje.</div>
                </div>
            `;
        }

        // Send message
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.innerHTML += `
                    <div class="chat-message sent">
                        <div class="message-bubble sent">${message}</div>
                    </div>
                `;
                input.value = '';
                
                // Simulate response
                setTimeout(() => {
                    chatMessages.innerHTML += `
                        <div class="chat-message">
                            <div class="message-bubble">‚úÖ Mensagem recebida e processada!</div>
                        </div>
                    `;
                    showNotification('Mensagem enviada via WhatsApp!');
                }, 1000);
            }
        }

        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Search inventory
        document.getElementById('searchInput')?.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#inventoryTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // File upload
        document.getElementById('fileInput')?.addEventListener('change', (e) => {
            const files = e.target.files;
            if (files.length > 0) {
                showNotification(`${files.length} arquivo(s) carregado(s) com sucesso!`);
            }
        });

        // Trial timer
        function updateTrialTimer() {
            const endTime = new Date(Date.now() + 36 * 60 * 60 * 1000);
            
            setInterval(() => {
                const now = new Date();
                const remaining = endTime - now;
                
                if (remaining > 0) {
                    const hours = Math.floor(remaining / (1000 * 60 * 60));
                    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
                    
                    document.getElementById('trialTimer').textContent = 
                        `${hours}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')} restantes`;
                }
            }, 1000);
        }

        // WebSocket connection for real-time updates
        function connectWebSocket() {
            // Connect to your backend
            // const socket = new WebSocket('wss://oyster-app-zqs92.ondigitalocean.app/ws');
            
            // For now, simulate incoming WhatsApp messages
            setInterval(() => {
                if (Math.random() > 0.7) {
                    const activities = [
                        'üêÑ Nascimento registrado via WhatsApp',
                        'üíâ Vacina√ß√£o registrada via WhatsApp',
                        'üöö Movimenta√ß√£o de gado registrada',
                        'üåßÔ∏è Precipita√ß√£o registrada: 15mm'
                    ];
                    
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    showNotification(activity);
                    
                    // Update stats
                    if (activity.includes('Nascimento')) {
                        demoData.totalCattle++;
                        demoData.birthsMonth++;
                        document.getElementById('totalCattle').textContent = demoData.totalCattle;
                        document.getElementById('birthsMonth').textContent = demoData.birthsMonth;
                    }
                }
            }, 10000); // Every 10 seconds
        }

        // Initialize
        window.onload = function() {
            // Clear cattle array before generating
            demoData.cattle = [];
            generateDemoCattle();
            generateDemoMessages();
            updateTrialTimer();
            connectWebSocket();

            initCharts();            
            // Set initial ranch name if provided
            const urlParams = new URLSearchParams(window.location.search);
            const ranchName = urlParams.get('ranch');
            if (ranchName) {
                document.getElementById('ranchName').textContent = ranchName;
            }
            
            // Language selector
            document.getElementById('languageSelector').addEventListener('change', (e) => {
                switchLanguage(e.target.value);
            });
        };
        
        
        // Language selector
            document.getElementById('languageSelector').addEventListener('change', (e) => {
                // For now, just store the selection
                currentLang = e.target.value;
                t = translations[currentLang];
                // In a full implementation, you'd update all text elements here
            });
        };
        
        // REAL Brazilian Weather API Functions
        function getWeather() {
            const city = document.getElementById('cityInput').value;
            if (!city) {
                alert('Por favor, digite o nome de uma cidade');
                return;
            }
            
            // Show loading state
            document.getElementById('temperature').textContent = '...';
            document.getElementById('weatherDescription').textContent = 'Buscando...';
            
            // Get coordinates for Brazilian city
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${city},Brazil&limit=1`)
                .then(response => response.json())
                .then(locationData => {
                    if (locationData.length === 0) {
                        alert('Cidade n√£o encontrada. Tente: Cuiab√°, Campo Grande, Goi√¢nia');
                        document.getElementById('temperature').textContent = '--¬∞C';
                        return;
                    }
                    
                    const lat = locationData[0].lat;
                    const lon = locationData[0].lon;
                    const displayName = locationData[0].display_name.split(',')[0];
                    
                    // Get REAL weather from Open-Meteo (FREE!)
                    return fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,precipitation,wind_speed_10m,weather_code,apparent_temperature&timezone=America/Sao_Paulo`)
                        .then(response => response.json())
                        .then(weatherData => {
                            // Update display with REAL data
                            document.getElementById('temperature').textContent = Math.round(weatherData.current.temperature_2m) + '¬∞C';
                            document.getElementById('weatherDescription').textContent = getWeatherDescription(weatherData.current.weather_code);
                            document.getElementById('cityName').textContent = displayName + ', Brasil';
                            document.getElementById('humidity').textContent = weatherData.current.relative_humidity_2m + '%';
                            document.getElementById('windSpeed').textContent = Math.round(weatherData.current.wind_speed_10m) + ' km/h';
                            document.getElementById('feelsLike').textContent = Math.round(weatherData.current.apparent_temperature) + '¬∞C';
                            document.getElementById('pressure').textContent = '1013 hPa';
                            
                            // Generate ranch alerts
                            generateRanchAlerts(weatherData.current);
                        });
                })
                .catch(error => {
                    console.error('Erro:', error);
                    document.getElementById('temperature').textContent = '--¬∞C';
                    document.getElementById('weatherDescription').textContent = 'Erro';
                });
        }

        // Convert weather codes to Portuguese
        function getWeatherDescription(code) {
            const descriptions = {
                0: 'C√©u limpo ‚òÄÔ∏è',
                1: 'Principalmente limpo üå§Ô∏è', 
                2: 'Parcialmente nublado ‚õÖ',
                3: 'Nublado ‚òÅÔ∏è',
                45: 'Neblina üå´Ô∏è',
                48: 'Geada ‚ùÑÔ∏è',
                51: 'Garoa leve üå¶Ô∏è',
                61: 'Chuva leve üåßÔ∏è',
                63: 'Chuva moderada üåßÔ∏è',
                65: 'Chuva forte üåßÔ∏è',
                80: 'Pancadas üå¶Ô∏è',
                95: 'Tempestade ‚õàÔ∏è'
            };
            return descriptions[code] || 'Vari√°vel';
        }

        // Ranch-specific alerts
        function generateRanchAlerts(current) {
            const temp = current.temperature_2m;
            const humidity = current.relative_humidity_2m;
            
            let tip = '';
            
            if (temp > 35) {
                tip = 'üî• ALERTA CALOR EXTREMO! Garanta √°gua abundante e sombra. Evite manejo entre 10h-16h.';
            } else if (temp < 10) {
                tip = '‚ùÑÔ∏è FRIO INTENSO! Forne√ßa alimenta√ß√£o extra. Proteja bezerros.';
            } else if (humidity > 85 && temp > 25) {
                tip = 'ü¶ü RISCO PARASITAS! Alta umidade favorece carrapatos. Intensifique monitoramento.';
            } else if (temp >= 20 && temp <= 28 && humidity >= 50 && humidity <= 70) {
                tip = '‚úÖ CONDI√á√ïES PERFEITAS! Ideal para vacina√ß√£o, pesagem e manejo geral.';
            } else {
                tip = 'üëç Condi√ß√µes normais para manejo do rebanho.';
            }
            
            document.getElementById('ranchTip').innerHTML = `<strong>${tip}</strong>`;
        }
        // Ranch-specific alerts
function generateRanchAlerts(current) {
    const temp = current.temperature_2m;
    const humidity = current.relative_humidity_2m;
    
    let tip = '';
    
    if (temp > 35) {
        tip = 'üî• ALERTA CALOR EXTREMO! Garanta √°gua abundante e sombra. Evite manejo entre 10h-16h.';
    } else if (temp < 10) {
        tip = '‚ùÑÔ∏è FRIO INTENSO! Forne√ßa alimenta√ß√£o extra. Proteja bezerros.';
    } else if (humidity > 85 && temp > 25) {
        tip = 'ü¶ü RISCO PARASITAS! Alta umidade favorece carrapatos. Intensifique monitoramento.';
    } else if (temp >= 20 && temp <= 28 && humidity >= 50 && humidity <= 70) {
        tip = '‚úÖ CONDI√á√ïES PERFEITAS! Ideal para vacina√ß√£o, pesagem e manejo geral.';
    } else {
        tip = 'üëç Condi√ß√µes normais para manejo do rebanho.';
    }
    
    document.getElementById('ranchTip').innerHTML = `<strong>${tip}</strong>`;
}

// ADD THE NEW FUNCTION HERE:
// Initialize Charts for Analytics Tab
function initCharts() {
    setTimeout(() => {
        // Growth Chart
        const growthCtx = document.getElementById('growthChart');
        if (growthCtx) {
            new Chart(growthCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [{
                        label: 'Total de Animais',
                        data: [120, 125, 130, 138, 145, 150],
                        borderColor: '#27ae60',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        tension: 0.3
                    }]
                }
            });
        }
        
        // Pasture Distribution
        const pastureCtx = document.getElementById('pastureChart');
        if (pastureCtx) {
            new Chart(pastureCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Pasto Esperan√ßa', 'Pasto Vit√≥ria', 'Pasto Liberdade', 'Pasto Progresso', 'Pasto Horizonte'],
                    datasets: [{
                        data: [35, 28, 25, 32, 30],
                        backgroundColor: ['#27ae60', '#2ecc71', '#16a085', '#1abc9c', '#3498db']
                    }]
                }
            });
        }
        
        // Costs Chart
        const costsCtx = document.getElementById('costsChart');
        if (costsCtx) {
            new Chart(costsCtx, {
                type: 'bar',
                data: {
                    labels: ['Ra√ß√£o', 'Veterin√°rio', 'Vacinas', 'Manuten√ß√£o', 'Transporte'],
                    datasets: [{
                        label: 'Custos (R$)',
                        data: [4500, 2200, 1800, 3200, 1500],
                        backgroundColor: '#e74c3c'
                    }]
                }
            });
        }
        
        // Birth Rate Chart
        const birthCtx = document.getElementById('birthRateChart');
        if (birthCtx) {
            new Chart(birthCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [{
                        label: 'Nascimentos',
                        data: [8, 12, 10, 15, 11, 12],
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        tension: 0.3
                    }]
                }
            });
        }
    }, 100);
}
</script>
</body>
</html>    
